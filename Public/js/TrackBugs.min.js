var module={},myFireBase,listOfIds=[];module.TrackBugs=function(){var e=[],t=[],s={bugsAssigned:[],bugsQA:[],bugsReady:[],bugsUnAssigned:[],UAT:[],ProductionTickets:[],BugNotAssigned:[],ProductionSupport:[],AssignedProductionTickets:[]},o=function(){i(),m(),a()},n=function(){$("#mgsPanel").hide(),$("#error").hide(),m()},i=function(){t=[],e=[];var s=$("#target_milestone").val().split(",");_.each(s,function(t){e.push(""+t)});var o=$("#product").val().split(",");_.each(o,function(e){t.push(""+e)})},a=function(){setInterval(m,1e4)},u=function(){i(),m()},r=function(e){var t={id:e.id,status:e.status,assigned_to:e.assigned_to.split("@")[0],summary:e.summary,devStartDate:"12/10/2016",devExpectedEndDate:"12/10/2016",bugFixedDate:"12/10/2016",bugVerifiedDate:"12/10/2016",redColor:!0,emberColor:!1,greenColor:!1,AssignedOn:void 0!=e.last_change_time?e.last_change_time.split("T")[0]:null,Creationtime:void 0!=e.creation_time?e.creation_time.split("T")[0]:null,CreationtimeDateFormat:void 0!=e.creation_time?new Date(new Date(e.creation_time.split("T")[0]).setHours(0,0,0,0)):null};return t},c=function(e){return _.each(e,function(e){_.each(e.Value,function(e){var t=new Date;t.setHours(0,0,0,0);var s=new Date(e.AssignedOn),o=new Date(s),n=new Date(s);o.setDate(o.getDate()+2),n.setDate(n.getDate()+5),o.setHours(0,0,0,0),n.setHours(0,0,0,0),t>=o&&n>t?(e.redColor=!1,e.emberColor=!0):n>t?(e.redColor=!1,e.emberColor=!1):(e.redColor=!0,e.emberColor=!1)})}),e},g=function(e){var t=[],s=[];return _.each(e,function(e){_.contains(t,e.assigned_to)||t.push(e.assigned_to)}),_.each(t,function(t){var o={Name:t,Value:_.where(e,{assigned_to:t})};s.push(o)}),s},d=function(e){var t=[],s=[],o=new Date;o.setHours(0,0,0,0);var n=new Date(o);n.setDate(n.getDate()-1);var i=[];return _.each(e,function(e){e.CreationtimeDateFormat<n||e.CreationtimeDateFormat>o||i.push(e)}),_.each(i,function(e){_.contains(t,e.assigned_to)||t.push(e.assigned_to)}),_.each(t,function(e){var t={Name:e,Value:_.where(i,{assigned_to:e})};s.push(t)}),s},p=function(e){s.bugsAssigned=[],s.bugsQA=[],s.bugsReady=[],s.BugNotAssigned=[],_.each(e,function(e){"resolved"==e.status.toLocaleLowerCase()?s.bugsQA.push(r(e)):"assigned"==e.status.toLocaleLowerCase()||"reopned"==e.status.toLocaleLowerCase()?s.bugsAssigned.push(r(e)):"verified"==e.status.toLocaleLowerCase()?s.bugsReady.push(r(e)):s.BugNotAssigned.push(r(e))}),$("#mgsPanel").hide(),$("#bugAssignedList").empty(),s.bugsAssigned.length>0?$("#bugBugTmp").tmpl(c(g(s.bugsAssigned))).appendTo("#bugAssignedList"):$("#bugAssignedList").text("No data to view"),$("#VerifiedbugList").empty(),$("#ReadybugBugTmp").tmpl(c(g(s.bugsReady))).appendTo("#VerifiedbugList"),$("#QAbugList").empty(),$("#QAbugBugTmp").tmpl(c(g(s.bugsQA))).appendTo("#QAbugList"),$("#displayData").show()},l=function(){var e=new Date;e.setHours(0,0,0,0);var o=new Date(e);o.setDate(o.getDate()-1);var n=[{Bugzilla_login:$("#userName").val(),Bugzilla_password:$("#pwd").val(),product:t,status:["NEW","REOPNED","ASSIGNED"]}],i={method:"Bug.search",params:JSON.stringify(n)};$.ajax({contentType:"application/json",data:i,crossDomain:"true",dataType:"jsonp",url:"https://bugzilla.emids.com/jsonrpc.cgi",type:"GET",success:function(e){null!=e.result&&(s.ProductionTickets=[],s.UAT=[],s.ProductionSupport=[],s.AssignedProductionTickets=[],_.each(e.result.bugs,function(e){1!=e.component.search("Tickets")?(s.ProductionTickets.push(r(e)),"ASSIGNED"==e.status||"REOPNED"==e.status?s.AssignedProductionTickets.push(r(e)):"---"==e.target_milestone&&s.BugNotAssigned.push(r(e)),s.AssignedProductionTickets):1!=e.component.search("Support")?(s.ProductionSupport.push(r(e)),"---"==e.target_milestone&&s.BugNotAssigned.push(r(e))):"lcca.com"==e.creator.split("@")[1].toLocaleLowerCase()&&(s.UAT.push(r(e)),"---"==e.target_milestone&&s.BugNotAssigned.push(r(e)))}),$("#ticketNew").empty(),$("#ticketTmp").tmpl(c(d(s.ProductionTickets))).appendTo("#ticketNew"),$("#bugNotAssignedUATList").empty(),$("#UATbugBugTmp").tmpl(c(d(s.UAT))).appendTo("#bugNotAssignedUATList"),$("#SupportNew").empty(),$("#ProductionSupportTmp").tmpl(c(d(s.ProductionSupport))).appendTo("#SupportNew"),$("#bugNotAssignedList").empty(),$("#notAssigneBugsTemp").tmpl(c(g(s.BugNotAssigned))).appendTo("#bugNotAssignedList"),$("#assignedTickets").empty(),$("#AssignedProductionTicketsTmp").tmpl(c(g(s.AssignedProductionTickets))).appendTo("#assignedTickets"))},error:function(){}})},m=function(){var s=[{Bugzilla_login:$("#userName").val(),Bugzilla_password:$("#pwd").val(),target_milestone:e,product:t,status:["NEW","ASSIGNED","VERIFIED","REOPNED","RESOLVED"]}],o={method:"Bug.search",params:JSON.stringify(s)};$.ajax({contentType:"application/json",data:o,crossDomain:"true",dataType:"jsonp",url:"https://bugzilla.emids.com/jsonrpc.cgi",type:"GET",success:function(e){$("#error").hide(),null!=e.result?(p(e.result.bugs),l()):($("#error").show(),$("#error").text("Incorrect UserName and Password ."))},error:function(e){$("#error").show(),$("#error").text(e)}})};return{init:o,connectBugzilla:m,rehabBugListViewModel:s,onclickSet:u,getproductionTicket:l,connectMeNow:n}}();