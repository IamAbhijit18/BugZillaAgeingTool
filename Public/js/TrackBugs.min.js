var module={},myFireBase,listOfIds=[];module.TrackBugs=function(){var e=[],t=[],s={bugsAssigned:[],bugsQA:[],bugsReady:[],bugsUnAssigned:[],UAT:[],ProductionTickets:[],BugNotAssigned:[]},i=function(){o(),n()},o=function(){t=[],e=[];var s=$("#target_milestone").val().split(",");_.each(s,function(t){e.push(""+t)});var i=$("#product").val().split(",");_.each(i,function(e){t.push(""+e)})},n=function(){setInterval(p,3e3)},a=function(){o(),p()},u=function(e){var t={id:e.id,status:e.status,assigned_to:e.assigned_to,summary:e.summary,devStartDate:"12/10/2016",devExpectedEndDate:"12/10/2016",bugFixedDate:"12/10/2016",bugVerifiedDate:"12/10/2016",redColor:!0,emberColor:!1,greenColor:!1,AssignedOn:void 0!=e.last_change_time?e.last_change_time.split("T")[0]:null,Creationtime:void 0!=e.creation_time?e.creation_time.split("T")[0]:null,CreationtimeDateFormat:void 0!=e.creation_time?new Date(new Date(e.creation_time.split("T")[0]).setHours(0,0,0,0)):null};return t},r=function(e){return _.each(e,function(e){_.each(e.Value,function(e){var t=new Date;t.setHours(0,0,0,0);var s=new Date(e.AssignedOn),i=new Date(s),o=new Date(s);i.setDate(i.getDate()+2),o.setDate(o.getDate()+5),i.setHours(0,0,0,0),o.setHours(0,0,0,0),t>=i&&o>t?(e.redColor=!1,e.emberColor=!0):o>t?(e.redColor=!1,e.emberColor=!1):(e.redColor=!0,e.emberColor=!1)})}),e},g=function(e){var t=[],s=[];return _.each(e,function(e){_.contains(t,e.assigned_to)||t.push(e.assigned_to)}),_.each(t,function(t){var i={Name:t,Value:_.where(e,{assigned_to:t})};s.push(i)}),s},c=function(e){var t=[],s=[],i=new Date;i.setHours(0,0,0,0);var o=new Date(i);o.setDate(o.getDate()-1);var n=[];return _.each(e,function(e){e.CreationtimeDateFormat<o||e.CreationtimeDateFormat>i||n.push(e)}),_.each(n,function(e){_.contains(t,e.assigned_to)||t.push(e.assigned_to)}),_.each(t,function(e){var t={Name:e,Value:_.where(n,{assigned_to:e})};s.push(t)}),s},d=function(e){s.bugsAssigned=[],s.bugsQA=[],s.bugsReady=[],s.UAT=[],s.BugNotAssigned=[],_.each(e,function(e){"resolved"==e.status.toLocaleLowerCase()?s.bugsQA.push(u(e)):"assigned"==e.status.toLocaleLowerCase()||"reopned"==e.status.toLocaleLowerCase()?s.bugsAssigned.push(u(e)):"verified"==e.status.toLocaleLowerCase()?s.bugsReady.push(u(e)):"lcca.com"==e.creator.split("@")[1].toLocaleLowerCase()&&"new"==e.status.toLocaleLowerCase()?(s.UAT.push(u(e)),s.BugNotAssigned.push(u(e))):s.BugNotAssigned.push(u(e))}),$("#mgsPanel").hide(),$("#bugAssignedList").empty(),s.bugsAssigned.length>0?$("#bugBugTmp").tmpl(r(g(s.bugsAssigned))).appendTo("#bugAssignedList"):$("#bugAssignedList").text("No data to view"),$("#VerifiedbugList").empty(),$("#ReadybugBugTmp").tmpl(r(g(s.bugsReady))).appendTo("#VerifiedbugList"),$("#QAbugList").empty(),$("#QAbugBugTmp").tmpl(r(g(s.bugsQA))).appendTo("#QAbugList"),$("#bugNotAssignedUATList").empty(),$("#UATbugBugTmp").tmpl(r(c(s.UAT))).appendTo("#bugNotAssignedUATList"),$("#bugNotAssignedList").empty(),$("#notAssigneBugsTemp").tmpl(r(g(s.BugNotAssigned))).appendTo("#bugNotAssignedList"),$("#displayData").show()},l=function(){var e=[{Bugzilla_login:"abhijit.mukherjee@emids.com",Bugzilla_password:"abhijit",component:"Production Tickets",product:t,status:"New"}],i={method:"Bug.search",params:JSON.stringify(e)};$.ajax({contentType:"application/json",data:i,crossDomain:"true",dataType:"jsonp",url:"https://bugzilla.emids.com/jsonrpc.cgi",type:"GET",success:function(e){console.log(e),null!=e.result.bugs&&(s.ProductionTickets=[],_.each(e.result.bugs,function(e){s.ProductionTickets.push(u(e))}),$("#ticketNew").empty(),$("#ticketTmp").tmpl(r(c(s.ProductionTickets))).appendTo("#ticketNew"))},error:function(){}})},p=function(){var s=[{Bugzilla_login:"abhijit.mukherjee@emids.com",Bugzilla_password:"abhijit",target_milestone:e,product:t}],i={method:"Bug.search",params:JSON.stringify(s)};$.ajax({contentType:"application/json",data:i,crossDomain:"true",dataType:"jsonp",url:"https://bugzilla.emids.com/jsonrpc.cgi",type:"GET",success:function(e){null!=e.result.bugs&&(d(e.result.bugs),l())},error:function(){}})};return{init:i,connectBugzilla:p,rehabBugListViewModel:s,onclickSet:a,getproductionTicket:l}}();